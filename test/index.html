<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Airblock Testing</title>
  </head>
  <body>
    <button
      id="connectbtn"
      type="
    button"
      onclick="connectWallet()"
    >
      Connect Wallet
    </button>

    <script type="module">
      import * as airblock from '../build/core/src/index.js'

      const connectWallet = async () => {
        try {
          if (typeof window.ethereum !== 'undefined') {
            let provider = window.ethereum
            // edge case if MM and CBW are both installed
            if (window.ethereum.providers?.length) {
              window.ethereum.providers.forEach(async p => {
                if (p.isMetaMask) provider = p
              })
            }
            await provider.request({
              method: 'eth_requestAccounts',
              params: []
            })
          }
        } catch (err) {
          airblock.metamask_error(err)
        }
      }

      document.getElementById('connectbtn').onclick = connectWallet

      await airblock.init('7bb141f9-3ccd-4fce-a5db-cc363d0b96b7', {})

      airblock.track('Event 1')
      airblock.track('Event 2')

      setTimeout(() => {
        airblock.track('Event 3')
      }, 1000)

      setTimeout(() => {
        airblock.track('Event 4')
      }, 3000)
    </script>
  </body>
</html>
